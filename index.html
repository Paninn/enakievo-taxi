<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–∫—Å–∏ –ï–Ω–∞–∫–∏–µ–≤–æ üöï</title>
    
    <!-- –ù–∞–¥—ë–∂–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ Telegram WebApp —Å–∫—Ä–∏–ø—Ç–∞ (–∏–∑–±–µ–≥–∞–µ–º –±–µ–ª–æ–≥–æ —ç–∫—Ä–∞–Ω–∞) -->
    <script>
        (function() {
            var script = document.createElement('script');
            script.src = 'https://telegram.org/js/telegram-web-app.js';
            script.onload = function() {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
                // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –≥–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ —Ç–µ–º—É Telegram
                Telegram.WebApp.MainButton.setParams({
                    color: '#4ecdc4',
                    text_color: '#ffffff'
                });
            };
            script.onerror = function() {
                document.body.innerHTML = '<h2 style="color:red;text-align:center;padding:50px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Telegram Web App.<br>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ Telegram.</h2>';
            };
            document.head.appendChild(script);
        })();
    </script>

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        .tariffs {
            background: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-size: 16px;
        }
        input {
            width: 100%;
            padding: 18px;
            margin: 10px 0;
            font-size: 18px;
            border: none;
            border-radius: 12px;
            background: rgba(255,255,255,0.95);
            color: #333;
        }
        input::placeholder {
            color: #888;
        }
        button {
            width: 100%;
            padding: 20px;
            margin: 15px 0;
            font-size: 20px;
            font-weight: bold;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        button:hover { background: #ff5252; }
        button:active { transform: scale(0.98); }
        #priceInfo {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin: 15px 0;
            font-size: 24px;
            font-weight: bold;
        }
        #orderBtn {
            background: #4ecdc4;
            display: none;
        }
        small { opacity: 0.9; font-size: 14px; }
    </style>
</head>
<body>
    <h1>üöï –¢–∞–∫—Å–∏ –ï–Ω–∞–∫–∏–µ–≤–æ</h1>
    
    <div class="tariffs">
        üí∞ –û–ø–ª–∞—Ç–∞ –¢–û–õ–¨–ö–û –ù–ê–õ–ò–ß–ù–´–ú–ò –≤–æ–¥–∏—Ç–µ–ª—é<br>
        ‚è±Ô∏è –ü–æ–¥–∞—á–∞ 5‚Äì15 –º–∏–Ω—É—Ç ‚Ä¢ –¶–µ–Ω—ã –æ—Ç 150 ‚ÇΩ –ø–æ –≥–æ—Ä–æ–¥—É
    </div>
    
    <input type="text" id="from" placeholder="üìç –û—Ç–∫—É–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –õ–µ–Ω–∏–Ω–∞ 10)">
    <input type="text" id="to" placeholder="üìç –ö—É–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ü–µ–Ω—Ç—Ä, –î–æ–Ω–µ—Ü–∫, –ó—É–≥—Ä—ç—Å)">
    <input type="tel" id="phone" placeholder="üì± –¢–µ–ª–µ—Ñ–æ–Ω (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
    <input type="text" id="comment" placeholder="üë• –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ø–∞—Å—Å–∞–∂–∏—Ä—ã, –±–∞–≥–∞–∂, –¥–µ—Ç—Å–∫–æ–µ –∫—Ä–µ—Å–ª–æ">
    
    <div id="priceInfo"></div>
    
    <button onclick="calculatePrice()">üí≤ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</button>
    <button id="orderBtn" onclick="sendOrder()">‚úÖ –ó–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏ (–Ω–∞–ª–∏—á–∫–æ–π)</button>

    <script>
        let orderData = {};

        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
        Telegram.WebApp.MainButton.setText("üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑");
        Telegram.WebApp.MainButton.onClick(sendOrder);
        Telegram.WebApp.MainButton.hide(); // –ü–æ–∫–∞ –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–ª–∏ —Ü–µ–Ω—É

        function calculatePrice() {
            const from = document.getElementById('from').value.trim();
            const to = document.getElementById('to').value.trim();
            const phone = document.getElementById('phone').value.trim();

            if (!from || !to || !phone) {
                alert('‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Ç–∫—É–¥–∞, –∫—É–¥–∞ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω!');
                return;
            }

            // –ü—Ä–æ—Å—Ç–æ–π —Ä–∞—Å—á—ë—Ç —Ü–µ–Ω—ã –¥–ª—è –ï–Ω–∞–∫–∏–µ–≤–æ –∏ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–µ–π
            let price = 150; // –±–∞–∑–∞ –ø–æ –≥–æ—Ä–æ–¥—É

            const lowerTo = to.toLowerCase();
            const lowerFrom = from.toLowerCase();

            if (lowerTo.includes('–¥–æ–Ω–µ—Ü–∫') || lowerFrom.includes('–¥–æ–Ω–µ—Ü–∫')) price += 450;
            else if (lowerTo.includes('–∑—É–≥—Ä—ç—Å') || lowerFrom.includes('–∑—É–≥—Ä—ç—Å')) price += 120;
            else if (lowerTo.includes('—à–∞—Ö—Ç—ë—Ä—Å–∫') || lowerFrom.includes('—à–∞—Ö—Ç—ë—Ä—Å–∫')) price += 200;
            else if (lowerTo.includes('—Ö–∞—Ä—Ü—ã–∑—Å–∫') || lowerFrom.includes('—Ö–∞—Ä—Ü—ã–∑—Å–∫')) price += 250;
            else if (lowerTo.includes('–º–∞–∫–µ–µ–≤–∫–∞') || lowerFrom.includes('–º–∞–∫–µ–µ–≤–∫–∞')) price += 350;

            // –†–∞–Ω–¥–æ–º +10-50 —Ä—É–± –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
            price += Math.floor(Math.random() * 50) + 10;

            orderData = {
                from: from,
                to: to,
                phone: phone,
                comment: document.getElementById('comment').value.trim(),
                price: price
            };

            document.getElementById('priceInfo').innerHTML = 
                `üí∞ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${price} ‚ÇΩ (–Ω–∞–ª–∏—á–∫–æ–π)<br>
                 <small>–í—Ä–µ–º—è –≤ –ø—É—Ç–∏: ${Math.floor(Math.random() * 10) + 5}‚Äì${Math.floor(Math.random() * 15) + 15} –º–∏–Ω</small>`;

            document.getElementById('orderBtn').style.display = 'block';
            Telegram.WebApp.MainButton.show();
        }

        function sendOrder() {
            if (!orderData.price) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å!');
                return;
            }

            orderData.time = new Date().toLocaleString('ru-RU');
            orderData.user = Telegram.WebApp.initDataUnsafe.user || { id: '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' };

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
            Telegram.WebApp.sendData(JSON.stringify(orderData));
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º Web App
            Telegram.WebApp.close();
        }
    </script>
</body>
</html>
